<h2>Médicament</h2>

<div class="row">
    <div class="col" *ngFor="let drug of lastIntakes">
        <div class="card m-3">
            <h3 class="card-header">{{drug.label}}</h3>
            <div class="card-body">
                <p class="card-text text-success" *ngIf="nextIntake(drug) <= formatedCurrentDt">
                    <strong>Prise autorisée</strong>
                </p>
                <div *ngIf="nextIntake(drug) > formatedCurrentDt">
                    <div class="row card-text text-warning">
                        <div class="col-12 col-xl-6">
                            <strong>Prochaine prise autorisée :</strong>
                        </div>
                        <div class="col-12 col-xl-6 text-end">
                            <strong>{{nextIntake(drug)}}</strong>
                        </div>
                    </div>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" [style]="nextIntakeProgress(drug)"></div>
                    </div>
                </div>
            </div>
            <div class="card-footer text-end">
                <div class="btn-group" role="group">
                    <button type="button" class="btn btn-success d-flex align-items-center" title="Ajouter une prise"
                        (click)="addIntake(drug.id)"
                        [ngClass]="{'btn-warning': nextIntake(drug) > formatedCurrentDt,
                                'btn-success': nextIntake(drug) <= formatedCurrentDt}">
                        <i class="material-icons">healing</i>
                    </button>
                    <a class="btn btn-secondary d-flex align-items-center" [routerLink]="['/intake-list', drug.id]"
                        title="Voir la liste des prises"><i class="material-icons">reorder</i></a>
                </div>
            </div>
        </div>
    </div>
</div>

<hr />

<div class="d-flex justify-content-between">
    <h2>Suivi de l'INR</h2>
    <a class="btn btn-secondary d-flex align-items-center" [routerLink]="['/measure-list']"
        title="Voir la liste des mesures">
        <i class="material-icons">reorder</i>
    </a>
</div>

<div echarts [options]="inrGraphOptions" [merge]="inrGraphUpdateOptions" class="demo-chart"></div>

<div *ngIf="!production">
    <hr />
    <div class="row">
        <div class="col">
            <pre>lastIntakes : {{lastIntakes | json}}</pre>
            <pre>inrGraphUpdateOptions : {{inrGraphUpdateOptions | json}}</pre>
        </div>
        <div class="col">
            <pre>inrGraphOptions : {{inrGraphOptions | json}}</pre>
        </div>
    </div>
</div>